<div class="w-full md:col-span-2 p-6 sm:p-8 bg-white rounded-lg shadow-md text-sm"> 

  <div class="!text-green-600 mb-6 w-fit rounded flex gap-2 !text-xl items-center">
    <mat-icon> list_alt </mat-icon>
    <h2 class="font-semibold ">Listado de ingresos - Área Pagos</h2> 
  </div>

  <!-- Buscador -->
  <div class="flex items-center gap-3 mb-7 overflow-x-auto !bg-gray-50 dark:!bg-gray-900 w-fit p-3 shadow rounded">
    <input type="text" [(ngModel)]="valorBusqueda" (input)="aplicarFiltroManual($event)" placeholder="Buscar por RUT, nombre, NCU..." class="border border-gray-300 rounded-md px-4 py-2 w-full sm:w-auto min-w-[280px] text-sm focus:outline-none focus:ring-2 focus:ring-green-500"/>
    <button class="bg-green-500 hover:bg-green-600 text-white px-3 py-2 rounded-md flex items-center gap-1">
      <mat-icon>search</mat-icon>
      <span class="hidden sm:inline font-medium">Buscar</span>
    </button>
  </div>

  <!-- Tabla -->
  <div class="w-full overflow-x-auto !bg-white dark:!bg-gray-900 ">
    <table mat-table [dataSource]="dataSource" matSort class=" mat-elevation-z8 w-full dark:!text-gray-100 !border-none !bg-white ">

      <!-- Todas las columnas de Analisis + Pago -->
      <ng-container matColumnDef="fechaCreacion">
        <th mat-header-cell *matHeaderCellDef mat-sort-header class="!font-bold !text-sm !bg-green-500 !text-white rounded-l-md"> Fecha Creación </th>
        <td mat-cell *matCellDef="let element" class="text-gray-800 !text-sm truncate"> {{element.fechaCreacion | date:'dd/MM/yyyy'}} </td>
      </ng-container>

      <ng-container matColumnDef="rutFuncioario">
        <th mat-header-cell *matHeaderCellDef mat-sort-header class="!font-bold !text-sm !bg-green-500 !text-white"> RUT </th>
        <td mat-cell *matCellDef="let element" class="text-gray-800 !text-sm truncate"> {{element.rutFuncioario}} </td>
      </ng-container>

      <ng-container matColumnDef="nombreFuncionario">
        <th mat-header-cell *matHeaderCellDef mat-sort-header class="!font-bold !text-sm !bg-green-500 !text-white"> Nombre </th>
        <td mat-cell *matCellDef="let element" class="text-gray-800 !text-sm truncate"> {{element.nombreFuncionario}} </td>
      </ng-container>

      <ng-container matColumnDef="gradoFuncionario">
        <th mat-header-cell *matHeaderCellDef mat-sort-header class="!font-bold !text-sm !bg-green-500 !text-white"> Grado </th>
        <td mat-cell *matCellDef="let element" class="text-gray-800 !text-sm truncate"> {{element.gradoFuncionario}} </td>
      </ng-container>

      <ng-container matColumnDef="concepto">
        <th mat-header-cell *matHeaderCellDef mat-sort-header class="!font-bold !text-sm !bg-green-500 !text-white"> Concepto </th>
        <td mat-cell *matCellDef="let element" class="text-gray-800 !text-sm truncate"> {{element.concepto}} </td>
      </ng-container>

      <ng-container matColumnDef="periodoRemuneracion">
        <th mat-header-cell *matHeaderCellDef mat-sort-header class="!font-bold !text-sm !bg-green-500 !text-white"> Periodo remuneración </th>
        <td mat-cell *matCellDef="let element" class="text-gray-800 !text-sm truncate"> {{element.periodoRemuneracion | date:'MM/yyyy'}} </td>
      </ng-container>

      <ng-container matColumnDef="motivoPago">
        <th mat-header-cell *matHeaderCellDef mat-sort-header class="!font-bold !text-sm !bg-green-500 !text-white"> Motivo de Pago </th>
        <td mat-cell *matCellDef="let element" class="text-gray-800 !text-sm truncate"> {{element.motivoPago}} </td>
      </ng-container>

      <ng-container matColumnDef="montoRemuneracion">
        <th mat-header-cell *matHeaderCellDef mat-sort-header class="!font-bold !text-sm !bg-green-500 !text-white"> Monto </th>
        <td mat-cell *matCellDef="let element" class="text-gray-800 !text-sm truncate"> {{element.montoRemuneracion | currency:'':'':'1.0-0'}} </td>
      </ng-container>

      <ng-container matColumnDef="motivoBloqueo">
        <th mat-header-cell *matHeaderCellDef mat-sort-header class="!font-bold !text-sm !bg-green-500 !text-white"> Motivo Bloqueo </th>
        <td mat-cell *matCellDef="let element" class="text-gray-800 !text-sm truncate"> {{element.motivoBloqueo}} </td>
      </ng-container>

      <ng-container matColumnDef="ncuDOE">
        <th mat-header-cell *matHeaderCellDef mat-sort-header class="!font-bold !text-sm !bg-green-500 !text-white"> NCU DOE </th>
        <td mat-cell *matCellDef="let element" class="text-gray-800 !text-sm truncate"> {{element.ncuDOE}} </td>
      </ng-container>

      <!-- Campos adicionales Pago -->
      <ng-container matColumnDef="nroNominaPago">
        <th mat-header-cell *matHeaderCellDef mat-sort-header class="!font-bold !text-sm !bg-green-500 !text-white"> N° Nómina </th>
        <td mat-cell *matCellDef="let element" class="text-gray-800 !text-sm truncate"> {{element.nroNominaPago || '---'}} </td>
      </ng-container>

      <ng-container matColumnDef="observacionesPago">
        <th mat-header-cell *matHeaderCellDef mat-sort-header class="!font-bold !text-sm !bg-green-500 !text-white"> Observaciones Pago </th>
        <td mat-cell *matCellDef="let element" class="text-gray-800 !text-sm truncate"> {{element.observacionesPago || '---'}} </td>
      </ng-container>

      <ng-container matColumnDef="estado">
        <th mat-header-cell *matHeaderCellDef mat-sort-header class="!font-bold !text-sm !bg-green-500 !text-white"> Estado </th>
        <td mat-cell *matCellDef="let element" class="text-yellow-700 !text-sm truncate"> {{element.estado}} </td>
      </ng-container>

      <ng-container matColumnDef="acciones">
        <th mat-header-cell *matHeaderCellDef class="!font-bold !text-sm !bg-green-500 !text-white rounded-r-md"> Acciones </th>
        <td mat-cell *matCellDef="let element" class="my-1.5 w-full text-white flex rounded-r-md">
          <button (click)="editarRegistro(element)" class="bg-amber-400 hover:bg-yellow-400 transition-colors cursor-pointer px-1.5 rounded-l-md">
            <mat-icon class="!text-lg">edit</mat-icon>
          </button>
          <button (click)="eliminarRegistro(element)" class="bg-red-500 hover:bg-red-600 transition-colors cursor-pointer px-1.5 rounded-r-md">
            <mat-icon class="!text-lg">delete</mat-icon>
          </button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;" class="!bg-gray-100 dark:!bg-gray-800 !text-gray-900 dark:!text-gray-100"></tr>

      <tr class="mat-row" *matNoDataRow>
        <td class="mat-cell" colspan="12">No hay datos que coincidan con "{{valorBusqueda}}"</td>
      </tr>
    </table>

    <mat-paginator class="!bg-white" [pageSizeOptions]="[5,10,25]" showFirstLastButtons></mat-paginator>
  </div>
</div>
